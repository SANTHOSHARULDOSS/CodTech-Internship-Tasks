import requests
from bs4 import BeautifulSoup
import sys
from urllib.parse import urljoin

def check_sql_injection(url):
    print(f"Scanning: {url}")
    
    # 1. Add a quote character to break the query
    vulnerable_url = url + "'"
    
    try:
        # 2. Send the request
        response = requests.get(vulnerable_url, timeout=5)
        
        # 3. Check for common SQL error messages
        errors = [
            "You have an error in your SQL syntax",
            "Warning: mysql",
            "unrecognized token",
            "syntax error"
        ]
        
        for error in errors:
            if error in response.text:
                print("\n[+] VULNERABILITY FOUND: SQL Injection!")
                print(f"[+] Link: {vulnerable_url}")
                print(f"[+] Error detected: {error}")
                return True
        
        print("[-] No common SQL errors found.")
        return False
        
    except Exception as e:
        print(f"Error connecting: {e}")
        return False

# --- MAIN PROGRAM ---
if __name__ == "__main__":
    print("--- WEB VULNERABILITY SCANNER ---")
    
    # ASK THE USER FOR THE LINK
    target_url = input("Enter the website URL to scan: ")
    
    # Run the scanner on the user's link
    check_sql_injection(target_url)
    
    print("\nScan complete.")
